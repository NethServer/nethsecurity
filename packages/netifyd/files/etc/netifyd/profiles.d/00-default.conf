# Default Netify Agent Configuration Profile
#
# Copy this file to /etc/netifyd/profiles.d/NN-NAME.conf to create
# a custom configuration profile.
############################################################################

[netifyd]
# Switch to non-root user on start-up.  Requires Linux Capabilities support
# to be enabled at compile time.  When running as a non-root user, the Agent
# will grant itself two capabilities: CAP_NET_ADMIN, CAP_NET_RAW
#user = netify
#group = netify

# On shutdown, force flows to immediately expire?  Otherwise, on shutdown,
# the Agent will linger until all flows have expired and have been purged,
# or a second termination request has been received.
auto_flow_expiry = yes

# The number of "buckets" the main flow map will be divided into.  the
# default is adequate for up to 5,000 flows.  Increasing this value will
# reduce the chances of flow map lock contention on systems that track a
# large number of flows.
flow_map_buckets = 128

# The maxiumum number of bytes to capture (copy) per packet.  Reducing this
# may be appropriate for embedded systems.  Reducing this value too much
# will result in less accurate application/protocol detection.  The maximum
# value is 65535, which is also the default.
max_capture_length = 65535

# The maxiumum number of packets to inspect per flow.  This is a performace
# tuning option for embedded systems.  Reducing this value too much will
# result in less accurate application/protocol detection, specifically TLS.
# Generally, a safe range for adequate detection accuracy would be between
# 15 - 25 packets.
max_detection_pkts = 32

# The maximum number of flows to track at any given moment.  When this value
# has been reached, new flows will stop being tracked until old flows
# expire.  This option can be used to conserve memory on embedded systems,
# or to set an upper safety limit to guard agains DDoS attacks or network
# scanning tools.
max_flows = 0

# Soft-dissectors are flow expressions defined in the application signatures
# configuration file (usually in /etc/netifyd/netify-apps.conf).
# For debugging or for embedded systems with very limited resources, it may
# be helpful to disable Soft-dissectors.
soft_dissectors = yes

# Don't track TCP flows until a SYN+ACK has been captured.  This option can
# offer protection agains network scanners and has the alternative benefit
# of not tracking already established TCP flows when the Agent is first
# started.
syn_scan_protection = no

# How long to wait (in seconds) until an idle flow is scheduled for expiry.
# This time-to-live (TTL) applies to all non-TCP flows.
ttl_idle_flow = 30

# How long to wait (in seconds) until an idle TCP flow is scheduled for
# expiry.
ttl_idle_tcp_flow = 300

# How often (in seconds) to process the global flow maps.  Flow statistics
# are made available, idle flows are expired, and other house-keeping is
# performed during this update period.  The default of 15s is appropriate
# in most cases.
update_interval = 15

# Periodically call getifaddrs(3) to update the associated IP addresses of
# each capture source, where applicable.  This option is primarily intended
# for non-Linux systems where an on-demand system like Netlink is non
# available.  Should be enabled for FreeBSD and variants.
use_getifaddrs = false

# Attach to an alternate network namespace.  The namespace can be specified
# as a name (/var/run/netns/<name>), or a PID (/proc/<PID>/ns/net), or as a
# full path.
# network_namespace = netify

# Capture Defaults
############################################################################

[capture-defaults]
# Default capture method for -I and -E command-line options.  Valid types
# include: pcap, tpv3
capture_type = pcap

# Packet capture timeout value (milliseconds).  How long reads from PCAP or
# TPv3 capture sources will wait for packet data before being cancelled and
# retrying.  The default value of 500ms is appropriate in almost all cases.
read_timeout = 500

# Threading Options
##############################################################################
[threads]
# Base CPU ID to start capture threads from.
#capture_base = 0
# Base CPU ID to start detection threads from.
#detection_base = 8
# Number of detection cores to start.
#detection_cores = 8

# Flow Hash Cache
############################################################################

[flow-hash-cache]
# When enabled, a flow's metadata hash along with the detected protocol and
# application ID will be cached for cases where a flow idles longer than the
# set TTL (ttl_idle_flow for non-TCP, and ttl_idle_tcp_flow for TCP).  When
# a flow's activity resumes, it will re-use the old hash and IDs from the
# cache if available.
enable = yes
save = persistent
cache_size = 1000

# DNS Hint Cache
############################################################################

[dns-hint-cache]
enable = yes
partial_lookups = no
save = persistent
cache_size = 1000

# Privacy Filter
############################################################################

[privacy-filter]
private_external_addresses = no

# Netify Informatics/API Integration
# https://www.netify.ai/products/netify-informatics
############################################################################

[netify-api]
# Enable/disable API integration with Netify Informatics
enable = no
update_tick = 30
update_interval = 86400
tls_verify = yes

# Protocol Dissector Options
############################################################################

[protocols]
# Enable all DPI protocol dissectors
all=include

# vim: set ft=dosini :
